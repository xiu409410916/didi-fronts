(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["common/main"],{3396:function(e,t,n){"use strict";(function(e){n("ea37"),n("921b");var t=u(n("66fd")),o=u(n("e328")),c=u(n("3de1")),a=u(n("5529")),r=u(n("2495"));function u(e){return e&&e.__esModule?e:{default:e}}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){l(e,t,n[t])})}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.default.config.productionTip=!1,t.default.prototype.$util=c.default,t.default.prototype.$config=r.default,t.default.prototype.$json=a.default,o.default.mpType="app";var s=new t.default(i({},o.default));e(s).$mount()}).call(this,n("543d")["createApp"])},"63ec":function(e,t,n){"use strict";n.r(t);var o=n("c9e7"),c=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=c.a},c43c:function(e,t,n){},c9e7:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("5af2"),c={globalData:{socket:""},onLaunch:function(t){var n=decodeURIComponent(t.scene);console.log("App Launch"),console.log("scene-----------"+n);var o=this;e.login({provider:"weixin",success:function(e){var t=e.code;o.loginByCode(t,n)}});var c=[];if(!e.getStorageSync("messageList")){c=[];e.setStorageSync("messageList",c)}},onShow:function(){console.log("App Show"),e.removeStorageSync("updateCart"),this.getHistoryMessage()},onHide:function(){console.log("App Hide")},methods:{getHistoryMessage:function(){var t=this,n=e.getStorageSync("patientInfo");null!=n&&(e.showToast({icon:"none",title:"加载消息中...",mask:!0}),this.$util.request({url:"/didi-patient/message/getUserUnreadedMessage",param:{userId:n.openId},contentType:"application/x-www-form-urlencoded",success:function(e){var n=e.data;if(null!=n&&n.length>0)for(var o=0;o<n.length;o++){var c=n[o];console.log(c),t.$util.updateMessage(c,"0")}},error:function(){}}))},loginByCode:function(t,n){var o=this,c={};c.code=t,c.scene=n,o.$util.request({url:"/didi-patient/ex/login_by_weixin",param:c,contentType:"application/x-www-form-urlencoded",success:function(t){e.setStorageSync("Token",t.data.openId),e.setStorageSync("patientInfo",t.data),o.connectMsgServer(t.data)},error:function(){}})},connectMsgServer:function(t){var n=this,c=t.openId,a="http://localhost:9092?token="+c,r=o.connect(a);getApp().globalData.socket=r,r.on("connect",function(){console.log("系统通知: "+c+"成功连接至websocket服务器")}),r.on("disconnect",function(){console.log("系统通知: "+c+"已从websocket服务器断开连接")}),r.on("chat",function(t){var o=t;n.$util.updateMessage(o,"0"),e.vibrateLong(),console.log("系统通知: 收到来自"+t.username+"的悄悄话:"+t.msg.content)})}}};t.default=c}).call(this,n("543d")["default"])},e328:function(e,t,n){"use strict";n.r(t);var o=n("63ec");for(var c in o)"default"!==c&&function(e){n.d(t,e,function(){return o[e]})}(c);n("f663");var a,r,u=n("2877"),i=Object(u["a"])(o["default"],a,r,!1,null,null,null);t["default"]=i.exports},f663:function(e,t,n){"use strict";var o=n("c43c"),c=n.n(o);c.a}},[["3396","common/runtime","common/vendor"]]]);